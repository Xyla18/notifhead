<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Liste des musiques</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f0f2f5;
    padding: 20px;
  }
  h1 {
    text-align: center;
    color: #333;
  }
  ul {
    list-style: none;
    padding: 0;
    max-width: 600px;
    margin: 20px auto;
  }
  li {
    background: #fff;
    margin-bottom: 15px;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  }
  audio {
    display: block;
    margin-top: 10px;
    width: 100%;
  }
</style>
</head>
<body>

<h1>Ma playlist</h1>
<ul id="liste-musiques"></ul>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
<script>
  const supabaseUrl = 'https://hcjgggdnfznoitebphvs.supabase.co';
  const supabaseKey = 'CLE_SECRETE_A_METTRE_EN_PLACE_DANS_ENV'; // ⚠️ ne jamais exposer la vraie clé admin
  const supabase = supabase.createClient(supabaseUrl, supabaseKey);

  async function loadMusiques() {
    const { data, error } = await supabase
      .from('musics')
      .select('*');

    if (error) {
      console.error(error);
      return;
    }

    const ul = document.getElementById('liste-musiques');
    data.forEach(m => {
      const li = document.createElement('li');
      li.innerHTML = `<strong>${m.title}</strong> par ${m.artist} <audio controls src="${m.url}"></audio>`;
      ul.appendChild(li);
    });
  }

  loadMusiques();
</script>

</body>
</html>
