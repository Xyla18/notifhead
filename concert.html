<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Concerts</title>
<style>
:root{--bg:#f9f9f9;--card:#fff;--muted:#666;--primary:#00ccff;--danger:#ff5555}
body{font-family:Segoe UI, Roboto, sans-serif;margin:0;background:var(--bg);color:#111}
header{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;background:#202020;color:#fff}
header h1{margin:0;font-size:1.2rem}
header .controls{display:flex;gap:8px;align-items:center}
button{cursor:pointer}
.btn{padding:8px 12px;border-radius:8px;border:none;font-weight:700}
.btn-primary{background:var(--primary);color:#000}
.btn-ghost{background:transparent;color:#fff;border:1px solid rgba(255,255,255,0.08)}
.container{max-width:980px;margin:20px auto;padding:0 16px;display:flex;flex-direction:column;gap:18px}
.card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
h2{margin:0 0 8px 0}
.concert-img{max-width:100%;border-radius:8px;margin-top:10px}
</style>
</head>
<body>
<header>
  <h1>Concerts √† venir</h1>
  <div class="controls">
    <button id="btnLogin" class="btn btn-primary">Admin</button>
  </div>
</header>

<main class="container" id="concertList">
  <div class="card">Chargement des concerts...</div>
</main>

<script type="module">
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

// ===== Supabase Config =====
const supabaseUrl = "https://hcjgggdnfznoitebphvs.supabase.co";
const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhjamdnZ2RuZnpub2l0ZWJwaHZzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA1MjA1MDEsImV4cCI6MjA3NjA5NjUwMX0.evgN1B1dp8H0007N4qskRxXiAICJPajBAbgYFsPyX3s"; 
const supabase = createClient(supabaseUrl, supabaseKey);

const concertList = document.getElementById("concertList");
document.getElementById("btnLogin").onclick = () => { window.location.href="admin_concerts.html"; };

async function loadConcerts(){
  const { data, error } = await supabase.from('concerts').select('*').order('date',{ascending:true});
  if(error){
    concertList.innerHTML = `<div class="card">Erreur: ${error.message}</div>`;
    return;
  }

  if(!data.length){
    concertList.innerHTML = `<div class="card">Aucun concert programm√©.</div>`;
    return;
  }

  concertList.innerHTML = "";
  data.forEach(c=>{
    const div = document.createElement("div");
    div.className = "card";
    const imgTag = c.image_url ? `<img src="${c.image_url}" class="concert-img">` : '';
    div.innerHTML = `
      ${imgTag}
      <h2>${c.title}</h2>
      <p>üìÖ ${c.date} ${c.time || ''}<br>üìç ${c.lieu || ''}</p>
      <p>${c.desc || ''}</p>
    `;
    concertList.appendChild(div);
  });
}

loadConcerts();
</script>
</body>
</html>
